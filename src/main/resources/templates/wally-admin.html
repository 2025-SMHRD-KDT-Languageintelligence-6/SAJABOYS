<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>윌리를 찾아라 관리 | 추적자 관리자</title>

  <!-- Verti 기본 CSS -->
  <link rel="stylesheet" href="/assets/css/main.css" />

  <style>
    body { background:#f5fafc; }

    .wally-admin-layout{
      max-width:1200px;
      margin:2rem auto 3rem;
      padding:0 1rem;
      display:grid;
      grid-template-columns: 1.3fr 1.7fr;
      gap:1.5rem;
    }

    .admin-panel{
      background:#ffffff;
      border-radius:14px;
      padding:1.4rem 1.6rem;
      box-shadow:0 8px 20px rgba(15,23,42,0.08);
    }
    .admin-panel + .admin-panel{ margin-top:1rem; }

    .admin-panel h2{
      margin:0 0 .6rem;
      font-size:1.3rem;
      font-weight:800;
    }
    .admin-panel p.sub{
      margin:0 0 1rem;
      font-size:0.9rem;
      color:#6b7280;
    }

    .field-group{
      display:flex;
      flex-direction:column;
      gap:.35rem;
      margin-bottom:1rem;
    }
    .field-group label{
      font-weight:600;
      font-size:0.95rem;
    }
    .field-group input[type="text"],
    .field-group input[type="number"],
    .field-group input[type="file"],
    .field-group textarea{
      font-size:0.95rem;
      padding:0.45rem 0.55rem;
      border-radius:8px;
      border:1px solid #d1d5db;
      background:#f9fafb;
    }
    .field-group small{
      font-size:0.8rem;
      color:#9ca3af;
    }

    .btn-row{
      display:flex;
      flex-wrap:wrap;
      gap:.6rem;
      margin-top:.3rem;
    }
    .btn{
      display:inline-flex;
      align-items:center;
      justify-content:center;
      padding:.45rem .9rem;
      border-radius:999px;
      border:none;
      cursor:pointer;
      font-size:0.9rem;
      font-weight:600;
      text-decoration:none;
      white-space:nowrap;
    }
    .btn-primary{
      background:#fb923c;
      color:#fff;
    }
    .btn-secondary{
      background:#e5e7eb;
      color:#374151;
    }

    .thumbnail{
      width:100%;
      max-width:220px;
      aspect-ratio:3/4;
      border-radius:12px;
      border:1px dashed #d1d5db;
      background:#f9fafb;
      display:flex;
      align-items:center;
      justify-content:center;
      font-size:0.85rem;
      color:#9ca3af;
      overflow:hidden;
      margin-top:.4rem;
    }
    .thumbnail img{
      width:100%;
      height:100%;
      object-fit:cover;
    }

    .qr-preview{
      width:140px;
      height:140px;
      border-radius:16px;
      border:1px dashed #d1d5db;
      background:#f9fafb;
      display:flex;
      align-items:center;
      justify-content:center;
      font-size:0.85rem;
      color:#9ca3af;
      overflow:hidden;
      margin-top:.4rem;
    }
    .qr-preview img{
      width:100%;
      height:100%;
      object-fit:contain;
    }

    /* 오른쪽 영역 */
    .wally-right-column .admin-panel{
      height:100%;
    }

    .finder-table{
      width:100%;
      border-collapse:collapse;
      font-size:0.9rem;
      margin-top:0.5rem;
    }
    .finder-table thead{
      background:#f3f4f6;
    }
    .finder-table th,
    .finder-table td{
      border:1px solid #e5e7eb;
      padding:0.4rem 0.5rem;
      text-align:center;
    }
    .finder-table tbody tr:nth-child(even){
      background:#f9fafb;
    }

    .festival-note{
      font-size:0.8rem;
      color:#6b7280;
      margin-top:0.25rem;
    }

    @media (max-width: 900px){
      .wally-admin-layout{
        grid-template-columns:1fr;
      }
    }
  </style>
</head>
<body class="is-preload">

<div id="page-wrapper">

  <!-- (필요하다면 공용 헤더 include) -->
  <!-- <jsp:include page="/WEB-INF/views/common/header.jsp" /> -->

  <section class="container">
    <header class="major">
      <h2>「윌리를 찾아라」 관리자 페이지</h2>
      <p>INDEX 메인에 노출될 윌리 이미지 · QR코드 · 참여자 · 축제 장소를 관리합니다.</p>
    </header>

    <div class="wally-admin-layout">

      <!-- ====== 좌측 : 윌리 & QR 관리 ====== -->
      <div>

        <!-- 1. 오늘의 윌리 사진 업로드 -->
        <div class="admin-panel">
          <h2>1. 오늘의 윌리 설정</h2>
          <p class="sub">INDEX 화면에 노출될 윌리 사진을 업로드합니다.</p>

          <form id="wallyImageForm" method="post" enctype="multipart/form-data">
            <div class="field-group">
              <label for="wallyImage">윌리 사진 업로드</label>
              <input type="file" id="wallyImage" name="wallyImage" accept="image/*" />
              <small>※ 세로형(예: 3:4 비율)의 축제장 사진을 권장합니다.</small>
            </div>

            <div class="thumbnail" id="wallyImagePreview">
              <!-- 서버에서 불러온 현재 이미지가 있다면 <img src="..."> 로 채워주세요 -->
              현재 등록된 윌리 이미지 없음
            </div>

            <div class="btn-row">
              <button type="submit" class="btn btn-primary">윌리 이미지 저장</button>
            </div>
          </form>
        </div>

        <!-- 2. 월리가 가지고 다닐 QR 코드 / 4. QR 코드 생성 -->
        <div class="admin-panel">
          <h2>2. 윌리가 가지고 다닐 QR 코드</h2>
          <p class="sub">윌리를 찾은 사람이 찍을 QR 코드를 관리합니다.</p>

          <!-- 현재 QR 미리보기 및 수동 업로드 -->
          <div class="field-group">
            <label>현재 적용 중인 QR 코드</label>
            <div class="qr-preview" id="currentQrPreview">
              <!-- 서버에서 불러온 QR 이미지가 있다면 <img src="..."> -->
              등록된 QR 코드 없음
            </div>
          </div>

          <form id="qrUploadForm" method="post" enctype="multipart/form-data">
            <div class="field-group">
              <label for="qrImage">QR 이미지 수동 업로드</label>
              <input type="file" id="qrImage" name="qrImage" accept="image/*" />
              <small>※ 외부에서 생성한 PNG/JPG QR 파일을 업로드할 수 있습니다.</small>
            </div>
            <div class="btn-row">
              <button type="submit" class="btn btn-secondary">QR 이미지 저장</button>
            </div>
          </form>

          <hr style="margin:1.2rem 0; border:none; border-top:1px dashed #e5e7eb;">

          <!-- 4. QR 코드 생성 창 -->
          <h2 style="margin-top:0;">4. QR 코드 생성</h2>
          <p class="sub">관리자 페이지에서 직접 QR 코드를 생성해 적용할 수도 있습니다.</p>

          <form id="qrGenerateForm" method="post">
            <div class="field-group">
              <label for="qrContent">QR 코드 내용 (URL 또는 텍스트)</label>
              <input type="text" id="qrContent" name="qrContent"
                     placeholder="예) https://chujak.com/event/wally/2025-01-01" />
            </div>

            <div class="field-group">
              <label for="qrMemo">관리용 메모</label>
              <textarea id="qrMemo" name="qrMemo" rows="2"
                        placeholder="예) 2025-01-01 야간축제 윌리 인증용 QR"></textarea>
            </div>

            <div class="btn-row">
              <button type="submit" class="btn btn-primary">QR 코드 생성 & 적용</button>
            </div>
          </form>
        </div>

      </div>

      <!-- ====== 우측 : 참여자 목록 & 축제 장소 ====== -->
      <div class="wally-right-column">

        <!-- 3. 월리를 찾은 사람(= QR 스캔한 사람) 목록 -->
        <div class="admin-panel">
          <h2>3. 월리를 찾은 사람 목록</h2>
          <p class="sub">
            월리를 찾고 QR을 찍은 방문객 목록입니다.  
            (※ QR 스캔 로그를 DB에서 불러와 표를 구성해주세요.)
          </p>

          <table class="finder-table">
            <thead>
            <tr>
              <th>번호</th>
              <th>닉네임 / 이름</th>
              <th>스캔 시간</th>
              <th>축제장 번호</th>
              <th>비고</th>
            </tr>
            </thead>
            <tbody>
            <!-- 예시 행 / 실제로는 서버에서 반복문으로 채우기 -->
            <!--
            <c:forEach var="finder" items="${wallyFinderList}" varStatus="st">
              <tr>
                <td>${st.count}</td>
                <td>${finder.userName}</td>
                <td><fmt:formatDate value="${finder.scanTime}" pattern="yyyy-MM-dd HH:mm"/></td>
                <td>${finder.festivalId}</td>
                <td>${finder.memo}</td>
              </tr>
            </c:forEach>
            -->
            <tr>
              <td colspan="5">아직 QR을 스캔한 사람이 없습니다.</td>
            </tr>
            </tbody>
          </table>
        </div>

        <!-- 5. 월리가 있는 축제 장소 입력 창 -->
        <div class="admin-panel">
          <h2>5. 월리가 있는 축제 장소</h2>
          <p class="sub">
            오늘의 윌리가 숨어 있는 축제장을 지정합니다.<br>
            <strong>※ 축제장 사진은 따로 업로드하지 않고, DB에서 검색해 가져옵니다.</strong>
          </p>

          <form id="wallyFestivalForm" method="post">
            <div class="field-group">
              <label for="festivalName">축제장 이름</label>
              <input type="text" id="festivalName" name="festivalName"
                     placeholder="예) 순천 불빛축제" />
            </div>

            <div class="field-group">
              <label for="festivalId">축제장 번호 (DB 키값)</label>
              <input type="number" id="festivalId" name="festivalId"
                     placeholder="예) 103 (tb_festival.fes_idx)" />
              <p class="festival-note">
                · 입력한 축제장 번호로 DB에서 축제 정보를 조회하여  
                INDEX &lt;윌리가 있는 축제장&gt; 영역에 자동 반영됩니다.
              </p>
            </div>

            <div class="btn-row">
              <button type="submit" class="btn btn-primary">윌리 위치 저장</button>
              <button type="button" class="btn btn-secondary">축제 검색 팝업 열기 (추후 구현)</button>
            </div>
          </form>
        </div>

      </div>

    </div>
  </section>

  <!-- (필요하다면 공용 푸터 include) -->
  <!-- <jsp:include page="/WEB-INF/views/common/footer.jsp" /> -->

</div>

</body>
</html>
